# Suricata Rules Validator

ä¸€ä¸ªåŸºäºŽ FastAPI çš„å®žæ—¶æ—¥å¿—ç›‘æŽ§å’Œ Suricata è§„åˆ™ç®¡ç†ç³»ç»Ÿã€‚

## ðŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–
```bash
# ä½¿ç”¨ uv (æŽ¨è)
uv sync

# æˆ–ä½¿ç”¨ pip
pip install -e .
```

### å¯åŠ¨æœåŠ¡
```bash
python run_server.py
```

è®¿é—® http://localhost:8000 å¼€å§‹ä½¿ç”¨ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

- **å®žæ—¶æ—¥å¿—ç›‘æŽ§** - åŒæ—¶ç›‘æŽ§ DTrace å’Œ Suricata æ—¥å¿—æ–‡ä»¶
- **è§„åˆ™åœ¨çº¿ç¼–è¾‘** - è¿œç¨‹ç¼–è¾‘å’Œä¿å­˜ Suricata è§„åˆ™æ–‡ä»¶
- **è§„åˆ™é‡è½½** - ä¸€é”®é‡è½½è§„åˆ™å¹¶éªŒè¯ç»“æžœ
- **æ—¥å¿—è¿‡æ»¤** - æŒ‰ç±»åž‹è¿‡æ»¤å’Œåˆ†ç±»æ˜¾ç¤ºæ—¥å¿—
- **çŠ¶æ€ç›‘æŽ§** - SSH å’Œ WebSocket è¿žæŽ¥çŠ¶æ€å®žæ—¶ç›‘æŽ§

## ðŸ› ï¸ æŠ€æœ¯æ ˆ

- **åŽç«¯**: FastAPI + WebSocket
- **æ–‡ä»¶ç›‘æŽ§**: Watchdog
- **SSH è¿žæŽ¥**: Paramiko
- **å‰ç«¯**: åŽŸç”Ÿ JavaScript + Socket.IO

## ðŸ“ é¡¹ç›®ç»“æž„

```
src/
â”œâ”€â”€ enhanced_log_watcher.py  # ä¸»åº”ç”¨ (FastAPI)
â”œâ”€â”€ log_collector.py         # æ—¥å¿—æ”¶é›†å™¨
â”œâ”€â”€ ssh_manager.py          # SSH è¿žæŽ¥ç®¡ç†
â””â”€â”€ log_watcher.py          # å¤‡ç”¨æ—¥å¿—ç›‘æŽ§
logs/                       # æ—¥å¿—æ–‡ä»¶ç›®å½•
run_server.py              # æœåŠ¡å¯åŠ¨å…¥å£
run_log_collector.py      # æ—¥å¿—æ”¶é›†å™¨å¯åŠ¨å…¥å£
```

## âš™ï¸ é…ç½®

ç¼–è¾‘ `src/ssh_manager.py` é…ç½® SSH è¿žæŽ¥ï¼š
- è¿œç¨‹ä¸»æœºåœ°å€å’Œç«¯å£
- SSH ç”¨æˆ·åå’Œç§é’¥è·¯å¾„
- Suricata è§„åˆ™æ–‡ä»¶è·¯å¾„

## ðŸ“ ä½¿ç”¨è¯´æ˜Ž

1. **æ—¥å¿—ç›‘æŽ§**: å¯åŠ¨åŽè‡ªåŠ¨æ˜¾ç¤ºå®žæ—¶æ—¥å¿—ï¼Œæ”¯æŒç±»åž‹è¿‡æ»¤
2. **è§„åˆ™ç¼–è¾‘**: ç‚¹å‡»"åŠ è½½è§„åˆ™" â†’ ç¼–è¾‘ â†’ "ä¿å­˜è§„åˆ™"
3. **è§„åˆ™é‡è½½**: ç‚¹å‡»"é‡è½½è§„åˆ™"æ‰§è¡Œè¿œç¨‹é‡è½½å‘½ä»¤

## ðŸ”§ æ•…éšœæŽ’é™¤

- **SSH è¿žæŽ¥å¤±è´¥**: æ£€æŸ¥ç½‘ç»œå’Œ SSH é…ç½®
- **æ—¥å¿—ä¸æ˜¾ç¤º**: ç¡®è®¤æ—¥å¿—æ–‡ä»¶è·¯å¾„å’Œæƒé™
- **è§„åˆ™ç¼–è¾‘å¤±è´¥**: éªŒè¯è¿œç¨‹æ–‡ä»¶è·¯å¾„å’Œæƒé™

---

**License**: MIT | **Python**: >=3.13 